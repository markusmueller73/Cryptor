; * CRYPTOR;  *;  * conf_functions.pbi;  *;--------------------------------------------------------------------------------;- functionsMacro set_config_filename  CompilerIf #PB_Compiler_Debugger    Protected.s filename = APP_CONF_DIR$ + LCase(#APP_NAME) + "_dbg" + #APP_CONF_EXT  CompilerElse    Protected.s filename = APP_CONF_DIR$ + LCase(#APP_NAME) + #APP_CONF_EXT  CompilerEndIfEndMacroProcedure.b load_settings( *conf.APP_SETTINGS )    set_config_filename    If OpenPreferences(filename, #PB_Preference_GroupSeparator | #PB_Preference_NoSpace)        PreferenceGroup("WINDOW")    *conf\pos_x  = ReadPreferenceLong("X-position", #PB_Ignore)    *conf\pos_y  = ReadPreferenceLong("Y-position", #PB_Ignore)    *conf\width  = ReadPreferenceLong("Width", #APP_WINDOW_WIDTH)    *conf\height = ReadPreferenceLong("Height", #APP_WINDOW_HEIGHT)        PreferenceGroup("LANGUAGE")    *conf\language = ReadPreferenceString("Application language", "en")        PreferenceGroup("PASSWORD GENERATOR")    *conf\pw_len     = ReadPreferenceLong("Length", 16)    *conf\pw_start   = ReadPreferenceLong("Starts with", 2)    *conf\pw_uc      = ReadPreferenceLong("Upper case", 5)    *conf\pw_lc      = ReadPreferenceLong("Lower case", 5)    *conf\pw_num     = ReadPreferenceLong("Numbers", 6)    *conf\pw_special = ReadPreferenceLong("Special chars", 0)    *conf\pw_valids  = ReadPreferenceLong("Valid specials", 1)    *conf\pw_hyphen  = ReadPreferenceLong("Add hyphen", 1)        PreferenceGroup("FILES")    *conf\lastFilename = ReadPreferenceString("Last used file", GetUserDirectory(#PB_Directory_Documents) + "untitled" + #APP_EXT)        PreferenceGroup("ENV")    *conf\version = ReadPreferenceLong("Version", 0)        ClosePreferences()        info("App settings successfully loaded.")      Else        *conf\pos_x  = #PB_Ignore    *conf\pos_y  = #PB_Ignore    *conf\width  = #APP_WINDOW_WIDTH    *conf\height = #APP_WINDOW_HEIGHT        *conf\language = "en"        *conf\pw_len     = 16    *conf\pw_start   = #BEGIN_WITH_LOWER_CASE    *conf\pw_uc      = 4    *conf\pw_lc      = 8    *conf\pw_num     = 4    *conf\pw_special = 0    *conf\pw_valids  = 1    *conf\pw_hyphen  = 1        *conf\lastFilename = GetUserDirectory(#PB_Directory_Documents) + ""        *conf\version = #APP_VER        info("Can't open settings file.")        ProcedureReturn #False      EndIf    ProcedureReturn #True  EndProcedureProcedure.b save_settings( *conf.APP_SETTINGS )    set_config_filename    If CreatePreferences(filename, #PB_Preference_GroupSeparator | #PB_Preference_NoSpace)        PreferenceComment(#APP_NAME + " " + #APP_VERSION + " config file")    PreferenceComment("DO NOT EDIT OR MODIFY THIS FILE")    PreferenceComment("")        PreferenceGroup("WINDOW")    WritePreferenceLong("X-position", *conf\pos_x)    WritePreferenceLong("Y-position", *conf\pos_y)    WritePreferenceLong("Width", *conf\width)    WritePreferenceLong("Height", *conf\height)        PreferenceGroup("LANGUAGE")    WritePreferenceString("Application language", *conf\language)        PreferenceGroup("PASSWORD GENERATOR")    WritePreferenceLong("Length", *conf\pw_len)    WritePreferenceLong("Starts with", *conf\pw_start)    WritePreferenceLong("Upper case", *conf\pw_uc)    WritePreferenceLong("Lower case", *conf\pw_lc)    WritePreferenceLong("Numbers", *conf\pw_num)    WritePreferenceLong("Special chars", *conf\pw_special)    WritePreferenceLong("Valid special", *conf\pw_valids)    WritePreferenceLong("Add hyphen", *conf\pw_hyphen)        PreferenceGroup("FILES")    WritePreferenceString("Last used file", *conf\lastFilename)        PreferenceGroup("ENV")    WritePreferenceLong("Version", #APP_VER)        ClosePreferences()        info("App settings successfully saved.")      Else    warn("Can't create settings file in directory: " + APP_CONF_DIR$)    ProcedureReturn #False  EndIf    ProcedureReturn #True  EndProcedure; IDE Options = PureBasic 5.71 LTS (MacOS X - x64); CursorPosition = 62; FirstLine = 47; Folding = -; EnableXP; EnablePurifier; EnableCompileCount = 0; EnableBuildCount = 0; EnableExeConstant